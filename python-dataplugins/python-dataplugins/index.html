
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://operations.systemlink.io/python-dataplugins/python-dataplugins/" rel="canonical"/>
<link href="../../img/favicon.ico" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-5.5.12" name="generator"/>
<title>Python DataPlugins - SystemLink Operations Handbook</title>
<link href="../../assets/stylesheets/main.4dd2dd8d.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.6a5ad368.min.css" rel="stylesheet"/>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-126136185-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
</head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="ni" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#python-dataplugins">6. 
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="SystemLink Operations Handbook" class="md-header-nav__button md-logo" href="https://operations.systemlink.io" title="SystemLink Operations Handbook">
<svg style="enable-background:new 0 0 32 32;" version="1.1" viewbox="0 0 32 32" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px">
<style type="text/css">
	.st0{fill:#044123;}
	.st1{fill:#FFFFFF;}
	.st2{display:none;}
	.st3{display:inline;fill:#D3519D;fill-opacity:0.46;}
	.st4{display:inline;opacity:0.45;fill:#D3519D;}
</style>
<g id="Layer_1">
<g>
<path class="st0" d="M0,32V0l21.28,0C27.2,0.01,32,4.81,32,10.73V32H0z"></path>
</g>
<g>
<g>
<g>
<g>
<path class="st1" d="M15,17h-4c0,0,0-1.05,0-2.44c0-1.51,0.64-2.8,1.82-3.61c0.9-0.62,2.1-0.95,3.47-0.95H24v4h-7.21
						C15.5,14,15,14.63,15,15.7C15,16.43,15,17,15,17z"></path>
</g>
</g>
</g>
<g>
<g>
<g>
<path class="st1" d="M17,16h4c0,0,0,1.05,0,2.44c0,1.51-0.64,2.8-1.82,3.61c-0.9,0.62-2.1,0.95-3.47,0.95H8v-4h7.21
						C16.5,19,17,18.37,17,17.3C17,16.57,17,16,17,16z"></path>
</g>
</g>
</g>
</g>
</g>
<g class="st2" id="Layer_2">
<rect class="st3" height="16" width="16" x="8" y="8"></rect>
</g>
</svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            SystemLink Operations Handbook
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Python DataPlugins
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/ni/systemlink-operations-handbook/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
    Table of Contents
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/ni/systemlink-operations-handbook/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="Introduction">
      1. Introduction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../network-security/network-security/" title="Network Security">
      2. Network Security
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../rbac/rbac/" title="Workspaces and Role-based Access Control">
      3. Workspaces and Role-based Access Control
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../openid-connect/openid-connect/" title="Single Sign-on with OpenID Connect">
      4. Single Sign-on with OpenID Connect
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ldap/ldap/" title="Sign on with LDAP">
      5. Sign on with LDAP
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        6. Python DataPlugins
        <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Python DataPlugins">
      6. Python DataPlugins
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Python DataPlugins
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started">6.1 
    Getting Started
  </a>
<nav aria-label="Getting Started" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#plugin-class">6.1.1 
    Plugin Class
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#read-store">6.1.2 
    Read Store
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#callback-loading">6.2 
    Callback Loading
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#error-handling">6.3 
    Error Handling
  </a>
<nav aria-label="Error Handling" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#not-my-file">6.3.1 
    Not My File
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#export-dataplugin">6.4 
    Export DataPlugin
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#known-limitations">6.5 
    Known Limitations
  </a>
<nav aria-label="Known Limitations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#numpy-and-pandas">6.5.1 
    NumPy and Pandas
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#single-file-dataplugins">6.5.2 
    Single File DataPlugins
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#datetimestrptime">6.5.3 
    datetime.strptime
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Python DataPlugins
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started">6.1 
    Getting Started
  </a>
<nav aria-label="Getting Started" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#plugin-class">6.1.1 
    Plugin Class
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#read-store">6.1.2 
    Read Store
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#callback-loading">6.2 
    Callback Loading
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#error-handling">6.3 
    Error Handling
  </a>
<nav aria-label="Error Handling" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#not-my-file">6.3.1 
    Not My File
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#export-dataplugin">6.4 
    Export DataPlugin
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#known-limitations">6.5 
    Known Limitations
  </a>
<nav aria-label="Known Limitations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#numpy-and-pandas">6.5.1 
    NumPy and Pandas
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#single-file-dataplugins">6.5.2 
    Single File DataPlugins
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#datetimestrptime">6.5.3 
    datetime.strptime
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/ni/systemlink-operations-handbook/edit/master/handbook/python-dataplugins/python-dataplugins.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="python-dataplugins"><span class="enumerate-heading-plugin">6.</span> Python DataPlugins<a class="headerlink" href="#python-dataplugins" title="Permanent link">¶</a></h1>
<p>Create a DataPlugin to load, register, or search your custom file formats in LabVIEW or DIAdem, or to index, browse, and find your file formats with SystemLink DataFinder.</p>
<p>You can also create DataPlugins using C++, VBS, LabVIEW, or Python.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Browse through 230+ DataPlugins in the <a href="https://search.ni.com/nisearch/app/main/p/ap/global/lang/en/pg/1/sn/ssnav:dpl/">NI Store</a> to check whether there is an existing DataPlugin for your data format.</p>
</div>
<h2 id="getting-started"><span class="enumerate-heading-plugin">6.1</span> Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">¶</a></h2>
<p>Python DataPlugins consist of only one Python file that contains all the logic. Almost all language features of the official Python 3.5.9 and its base libraries can be used.</p>
<p>You can create Python DataPlugins in your favorite editor. Recommended:</p>
<ul>
<li><a href="https://www.ni.com/en-us/shop/data-acquisition-and-control/application-software-for-data-acquisition-and-control-category/what-is-diadem.html">DIAdem</a> &gt;= 2020</li>
<li>VSCode with the <a href="https://github.com/ni/vscode-ni-python-dataplugins">NI Python DataPlugin Extension</a></li>
</ul>
<h3 id="plugin-class"><span class="enumerate-heading-plugin">6.1.1</span> Plugin Class<a class="headerlink" href="#plugin-class" title="Permanent link">¶</a></h3>
<p>Start writing your DataPlugin by implementing</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Plugin</span><span class="p">:</span>
</code></pre></div>
<p>The class name cannot be changed.</p>
<h3 id="read-store"><span class="enumerate-heading-plugin">6.1.2</span> Read Store<a class="headerlink" href="#read-store" title="Permanent link">¶</a></h3>
<p>You need to implement a <code>read_store</code> method in every Python DataPlugin. This method is called by DIAdem, LabVIEW, or SystemLink DataFinder when attempting to open your data file. The applications pass a set of useful parameters that can be accessed by the parameter array.</p>
<!-- markdownlint-disable -->
<details>
<summary>Example Code</summary>
<!-- markdownlint-enable -->
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="k">def</span> <span class="nf">read_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
   <span class="sd">"""</span>
<span class="sd">      Reads data file and returns a Python dictionary</span>
<span class="sd">      that contains groups and channels in a TDM-like structure.</span>
<span class="sd">   """</span>

   <span class="c1"># String: Contains the absolute path to the data file</span>
   <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="s2">"file"</span><span class="p">])</span>
   <span class="c1"># Boolean: Denotes whether data file was accessed by SystemLink DataFinder</span>
   <span class="c1"># =&gt; the bulk data was not touched. </span>
   <span class="n">is_datafinder_indexer</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="s2">"datafinder"</span><span class="p">]</span>

   <span class="n">tdm_tree</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">"author"</span><span class="p">:</span> <span class="s2">"NI"</span><span class="p">,</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"File containing a json dict read by Python plugin"</span><span class="p">,</span>
      <span class="s2">"groups"</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Group_1"</span><span class="p">,</span>
            <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"First group"</span><span class="p">,</span>
            <span class="s2">"channels"</span><span class="p">:</span> <span class="p">[{</span>
               <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Index"</span><span class="p">,</span>
               <span class="s2">"description"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
               <span class="s2">"info"</span><span class="p">:</span> <span class="s2">"Going up"</span><span class="p">,</span>
               <span class="s2">"unit_string"</span><span class="p">:</span> <span class="s2">"s"</span><span class="p">,</span>
               <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"DataTypeChnFloat64"</span><span class="p">,</span>
               <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="p">},</span> <span class="p">{</span>
               <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Vals_1"</span><span class="p">,</span>
               <span class="s2">"description"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
               <span class="s2">"unit_string"</span><span class="p">:</span> <span class="s2">"km/h"</span><span class="p">,</span>
               <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"DataTypeChnFloat64"</span><span class="p">,</span>
               <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">]</span>
            <span class="p">},</span> <span class="p">{</span>
               <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Vals_2"</span><span class="p">,</span>
               <span class="s2">"description"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
               <span class="s2">"unit_string"</span><span class="p">:</span> <span class="s2">"km/h"</span><span class="p">,</span>
               <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"DataTypeChnFloat64"</span><span class="p">,</span>
               <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">]</span>
            <span class="p">},</span> <span class="p">{</span>
               <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Str_1"</span><span class="p">,</span>
               <span class="s2">"description"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
               <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"DataTypeChnString"</span><span class="p">,</span>
               <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"abc"</span><span class="p">,</span> <span class="s2">"def"</span><span class="p">,</span> <span class="s2">"hij"</span><span class="p">]</span>
            <span class="p">}]</span>
      <span class="p">},</span> <span class="p">{</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Group_2"</span><span class="p">,</span>
            <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Second group"</span><span class="p">,</span>
            <span class="s2">"channels"</span><span class="p">:</span> <span class="p">[{</span>
               <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Index"</span><span class="p">,</span>
               <span class="s2">"description"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
               <span class="s2">"info"</span><span class="p">:</span> <span class="s2">"Going up"</span><span class="p">,</span>
               <span class="s2">"unit_string"</span><span class="p">:</span> <span class="s2">"s"</span><span class="p">,</span>
               <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"DataTypeChnFloat64"</span><span class="p">,</span>
               <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="p">]</span>
      <span class="p">}]</span>
   <span class="p">}</span>

   <span class="k">return</span> <span class="p">{</span><span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">:</span> <span class="n">tdm_tree</span><span class="p">}</span>
</code></pre></div>
</details>
<p>Use the file parameter to access your file using text, CSV, or binary readers.
The data must be added to a Python dictionary. It represents the
<a href="https://www.ni.com/en-us/support/documentation/supplemental/06/the-ni-tdms-file-format.html">structure of tdm/tdms files</a>
that consists of one root, 0...m groups, and 0...n channels:</p>
<figure>
<img src="../../img/pydp-tdm_structure.png" width="500"/>
<figcaption>TDM structure with root, groups, and channels</figcaption>
</figure>
<!-- markdownlint-disable -->
<details>
<summary>Example dictionary</summary>
<!-- markdownlint-enable -->
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">tdm_tree</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">"author"</span><span class="p">:</span> <span class="s2">"NI"</span><span class="p">,</span>
   <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Example file"</span><span class="p">,</span>
   <span class="s2">"groups"</span><span class="p">:</span> <span class="p">[{</span>
         <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Example"</span><span class="p">,</span>
         <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"First group"</span><span class="p">,</span>
         <span class="s2">"time"</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">342380</span><span class="p">),</span>
         <span class="s2">"channels"</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Channel_0"</span><span class="p">,</span>
            <span class="s2">"description"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">],</span>
            <span class="s2">"info"</span><span class="p">:</span> <span class="s2">"Time in seconds"</span><span class="p">,</span>
            <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"DataTypeChnFloat64"</span>
         <span class="p">},</span> <span class="p">{</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Channel_1"</span><span class="p">,</span>
            <span class="s2">"description"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
            <span class="s2">"unit_string"</span><span class="p">:</span> <span class="s2">"km/h"</span><span class="p">,</span>
            <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"DataTypeChnFloat64"</span>
         <span class="p">}]</span>
   <span class="p">}]</span>
<span class="p">}</span>

<span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="s2">"file"</span><span class="p">])</span>
<span class="k">return</span> <span class="p">{</span><span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tdm_tree</span><span class="p">}</span>
</code></pre></div>
</details>
<!-- markdownlint-disable -->
<details>
<summary>Dictionary Schema</summary>
<!-- markdownlint-enable -->
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">schema</span> <span class="kn">import</span> <span class="n">And</span><span class="p">,</span> <span class="n">Schema</span>

<span class="n">Schema</span><span class="p">({</span>
      <span class="n">Optional</span><span class="p">(</span><span class="s1">'author'</span><span class="p">):</span> <span class="nb">str</span><span class="p">,</span>
      <span class="n">Optional</span><span class="p">(</span><span class="s1">'description'</span><span class="p">):</span> <span class="nb">str</span><span class="p">,</span>
      <span class="s1">'groups'</span><span class="p">:</span> <span class="p">[{</span>
         <span class="s1">'name'</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">Optional</span><span class="p">(</span><span class="s1">'description'</span><span class="p">):</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">Optional</span><span class="p">(</span><span class="s1">'time'</span><span class="p">):</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span>
         <span class="s1">'channels'</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s1">'name'</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">Optional</span><span class="p">(</span><span class="s1">'description'</span><span class="p">):</span> <span class="nb">str</span><span class="p">,</span>
            <span class="s1">'values'</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
            <span class="n">Optional</span><span class="p">(</span><span class="s1">'unit_string'</span><span class="p">):</span> <span class="nb">str</span><span class="p">,</span>
            <span class="s1">'type'</span><span class="p">:</span> <span class="n">And</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span>
               <span class="s1">'DataTypeChnFloat32'</span><span class="p">,</span>
               <span class="s1">'DataTypeChnFloat64'</span><span class="p">,</span>
               <span class="s1">'DataTypeChnString'</span><span class="p">,</span>
               <span class="s1">'DataTypeChnDate'</span><span class="p">,</span>
               <span class="s1">'DataTypeChnUInt8'</span><span class="p">,</span>
               <span class="s1">'DataTypeChnInt16'</span><span class="p">,</span>
               <span class="s1">'DataTypeChnInt32'</span><span class="p">,</span>
               <span class="s1">'DataTypeChnInt64'</span><span class="p">))</span>
            <span class="p">}]</span>
      <span class="p">}]},</span> <span class="n">ignore_extra_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

All additional "extra keys" will show up as custom properties in DIAdem, Labview,
or SystemLink DataFinder.

</details>
<p>See full example: <a href="https://github.com/ni/systemlink-operations-handbook/tree/master/examples/python-dataplugin-examples/csv-read-with-direct-loading">csv-read-with-direct-loading</a></p>
<h2 id="callback-loading"><span class="enumerate-heading-plugin">6.2</span> Callback Loading<a class="headerlink" href="#callback-loading" title="Permanent link">¶</a></h2>
<p>When handling a big data set, you might not want to load all data at the same time.
To ensure the DataPlugin only returns values that applications request:</p>
<ol>
<li>
<p>Assign an empty array to the channel values property:</p>
<div class="highlight"><pre><span></span><code><span class="o">...</span>
<span class="s1">'groups'</span><span class="p">:</span> <span class="p">[{</span>
   <span class="o">...</span>
   <span class="s1">'channels'</span><span class="p">:</span> <span class="p">[{</span>
      <span class="o">...</span>
      <span class="s1">'values'</span><span class="p">:</span> <span class="p">[],</span>
   <span class="p">}]</span>
<span class="p">}]</span>
</code></pre></div>
</li>
<li>
<p>Outsource the functionality to load the bulk data values in a separate function.
   The function has the following definition:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_channel_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grp_index</span><span class="p">,</span> <span class="n">chn_index</span><span class="p">,</span> <span class="n">numberToSkip</span><span class="p">,</span> <span class="n">numberToTake</span><span class="p">):</span>
   <span class="sd">"""</span>
<span class="sd">      Returns a value array of the correct data type specified in the TDM dictionary</span>
<span class="sd">   """</span>
</code></pre></div>
</li>
</ol>
<!-- markdownlint-disable -->
<details>
<summary>Example Code</summary>
<!-- markdownlint-enable -->
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_channel_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grp_index</span><span class="p">,</span> <span class="n">chn_index</span><span class="p">,</span> <span class="n">numberToSkip</span><span class="p">,</span> <span class="n">numberToTake</span><span class="p">):</span>
   <span class="n">dataType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tdm_tree</span><span class="p">[</span><span class="s2">"groups"</span><span class="p">][</span><span class="n">grp_index</span><span class="p">][</span><span class="s2">"channels"</span><span class="p">][</span><span class="n">chn_index</span><span class="p">][</span><span class="s2">"type"</span><span class="p">]</span>
   <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
   <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
      <span class="n">value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">channelNames</span><span class="p">[</span><span class="n">chn_index</span><span class="p">]]</span>
      <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="n">numberToSkip</span><span class="p">:</span><span class="n">numberToTake</span><span class="o">+</span><span class="n">numberToSkip</span><span class="p">]</span>
</code></pre></div>
</details>
<p>The client applications call this function to retrieve channel values (or
a subset of values). You need to implement the function to return the
values for a given group and channel index. You also need to ensure only the
correct subset of values is returned for a given <code>numberToSkip</code> and <code>numberToTake</code>.</p>
<p>In addition, you need to implement a callback function to retrieve the channel
length. If all channels have the same length, it simply returns a constant.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_channel_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grp_index</span><span class="p">,</span> <span class="n">chn_index</span><span class="p">):</span>
   <span class="sd">"""</span>
<span class="sd">      Returns the channel length as an Integer for a given group and channel index</span>
<span class="sd">   """</span>
   <span class="k">return</span> <span class="mi">10</span>
</code></pre></div>
<p>See full example: <a href="https://github.com/ni/systemlink-operations-handbook/tree/master/examples/python-dataplugin-examples/csv-read-with-callback-loading">csv-read-with-callback-loading</a></p>
<h2 id="error-handling"><span class="enumerate-heading-plugin">6.3</span> Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">¶</a></h2>
<p>Python DataPlugins can raise errors in all callback functions. The raised error
is displayed in DIAdem, LabVIEW, or SystemLink DataFinder.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
   <span class="o">...</span>
   <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"Leave read_store with exception"</span><span class="p">)</span>
</code></pre></div>
<h3 id="not-my-file"><span class="enumerate-heading-plugin">6.3.1</span> Not My File<a class="headerlink" href="#not-my-file" title="Permanent link">¶</a></h3>
<p>A special case is "Not My File". This error should be raised when the DataPlugin
detects that the file to be opened is not suited for this DataPlugin. This
special error can be raised only in the <code>read_store</code> function by returning <code>None</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
   <span class="o">...</span>
   <span class="k">if</span> <span class="n">notMyFile</span><span class="p">:</span>
      <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
<h2 id="export-dataplugin"><span class="enumerate-heading-plugin">6.4</span> Export DataPlugin<a class="headerlink" href="#export-dataplugin" title="Permanent link">¶</a></h2>
<p>Export Python DataPlugins to make them available on other systems. Use DIAdem to
export a DataPlugin as a URI file.</p>
<figure>
<img src="../../img/pydp-diadem_export.png" width="600"/>
<figcaption>Exporting DataPlugins in DIAdem</figcaption>
</figure>
<h2 id="known-limitations"><span class="enumerate-heading-plugin">6.5</span> Known Limitations<a class="headerlink" href="#known-limitations" title="Permanent link">¶</a></h2>
<h3 id="numpy-and-pandas"><span class="enumerate-heading-plugin">6.5.1</span> NumPy and Pandas<a class="headerlink" href="#numpy-and-pandas" title="Permanent link">¶</a></h3>
<p>Unfortunately, NumPy and Pandas are not well supported to run in embedded Python
environments and, therefore, cannot be used in DataPlugins.</p>
<h3 id="single-file-dataplugins"><span class="enumerate-heading-plugin">6.5.2</span> Single File DataPlugins<a class="headerlink" href="#single-file-dataplugins" title="Permanent link">¶</a></h3>
<p>Python DataPlugins can only be written in a single Python file. Importing sidecar
files is not supported. It will fail when exporting the DataPlugin as a URI.</p>
<h3 id="datetimestrptime"><span class="enumerate-heading-plugin">6.5.3</span> datetime.strptime<a class="headerlink" href="#datetimestrptime" title="Permanent link">¶</a></h3>
<p>There is an <a href="https://bugs.python.org/issue27400">open issue</a> in Python for
<code>datetime.strptime</code> that prevents the function from working properly in embedded
Python environments. Avoid using this function in DataPlugin source code.
Instead, add the following function to your code:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">strptime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">format</span><span class="p">):</span>
   <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">"</span><span class="si">%d</span><span class="s2">.%m.%y %H:%M:%S"</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]))</span>
</code></pre></div>
<hr/>
<div class="md-source-date">
<small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 22, 2021</span>
</small>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../../ldap/ldap/" rel="prev" title="Sign on with LDAP">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Sign on with LDAP
              </div>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2020 National Instruments Corporation
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.3636a4ec.min.js"></script>
<script src="../../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>