
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://operations.systemlink.io/upgrade/upgrade/" rel="canonical"/>
<link href="../../img/favicon.ico" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-5.5.12" name="generator"/>
<title>Upgrading and Migrating SystemLink Server - SystemLink Operations Handbook</title>
<link href="../../assets/stylesheets/main.4dd2dd8d.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.6a5ad368.min.css" rel="stylesheet"/>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-126136185-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
</head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="ni" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#upgrading-and-migrating-systemlink-server">8. 
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="SystemLink Operations Handbook" class="md-header-nav__button md-logo" href="https://operations.systemlink.io" title="SystemLink Operations Handbook">
<svg style="enable-background:new 0 0 32 32;" version="1.1" viewbox="0 0 32 32" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px">
<style type="text/css">
	.st0{fill:#044123;}
	.st1{fill:#FFFFFF;}
	.st2{display:none;}
	.st3{display:inline;fill:#D3519D;fill-opacity:0.46;}
	.st4{display:inline;opacity:0.45;fill:#D3519D;}
</style>
<g id="Layer_1">
<g>
<path class="st0" d="M0,32V0l21.28,0C27.2,0.01,32,4.81,32,10.73V32H0z"></path>
</g>
<g>
<g>
<g>
<g>
<path class="st1" d="M15,17h-4c0,0,0-1.05,0-2.44c0-1.51,0.64-2.8,1.82-3.61c0.9-0.62,2.1-0.95,3.47-0.95H24v4h-7.21
						C15.5,14,15,14.63,15,15.7C15,16.43,15,17,15,17z"></path>
</g>
</g>
</g>
<g>
<g>
<g>
<path class="st1" d="M17,16h4c0,0,0,1.05,0,2.44c0,1.51-0.64,2.8-1.82,3.61c-0.9,0.62-2.1,0.95-3.47,0.95H8v-4h7.21
						C16.5,19,17,18.37,17,17.3C17,16.57,17,16,17,16z"></path>
</g>
</g>
</g>
</g>
</g>
<g class="st2" id="Layer_2">
<rect class="st3" height="16" width="16" x="8" y="8"></rect>
</g>
</svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            SystemLink Operations Handbook
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Upgrading and Migrating SystemLink Server
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/ni/systemlink-operations-handbook/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
    Table of Contents
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/ni/systemlink-operations-handbook/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../network-security/network-security/" title="Network Security">
      Network Security
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../rbac/rbac/" title="Workspaces and Role-based Access Control">
      Workspaces and Role-based Access Control
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../openid-connect/openid-connect/" title="Single Sign-on with OpenID Connect">
      Single Sign-on with OpenID Connect
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ldap/ldap/" title="Sign on with LDAP">
      Sign on with LDAP
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" id="nav-6" type="checkbox"/>
<label class="md-nav__link" for="nav-6">
      Data stores
      <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Data stores" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-6">
<span class="md-nav__icon md-icon"></span>
        Data stores
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../data-stores/FileService-MinIO/" title="Leverage File Service S3 for on-premises storage">
      Leverage File Service S3 for on-premises storage
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../data-stores/mongodb/" title="MongoDB">
      MongoDB
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Upgrading and Migrating SystemLink Server
        <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Upgrading and Migrating SystemLink Server">
      Upgrading and Migrating SystemLink Server
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Upgrading and Migrating SystemLink Server
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#assumptions-and-prerequisites">8.1 
    Assumptions and Prerequisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#preparing-for-upgrade-or-migration">8.2 
    Preparing for Upgrade or Migration
  </a>
<nav aria-label="Preparing for Upgrade or Migration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ni-systemlink-migration-command-line-utility">8.2.1 
    NI-SystemLink-Migration Command Line Utility
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-from-systemlink-213-or-earlier-to-systemlink-215-or-later">8.2.2 
    Upgrading from SystemLink 21.3 or earlier to SystemLink 21.5 or later
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recommended-upgrade-and-migration-workflows-for-your-deployment">8.3 
    Recommended Upgrade and Migration Workflows for your deployment
  </a>
<nav aria-label="Recommended Upgrade and Migration Workflows for your deployment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-upgrade">8.3.1 
    Single Node Upgrade
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-to-multi-node-migration">8.3.2 
    Single Node to Multi Node Migration
  </a>
<nav aria-label="Single Node to Multi Node Migration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-to-multi-node-with-mongodb">8.3.2.1 
    Single Node to Multi Node with MongoDB
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-to-multi-node-with-file-storage">8.3.2.2 
    Single Node to Multi Node with File Storage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-to-multi-node-with-postgresql">8.3.2.3 
    Single Node to Multi Node with PostgreSQL
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-multi-node-configurations">8.3.3 
    Upgrading Multi Node Configurations
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#seamless-cut-over">8.4 
    Seamless Cut-over
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../python-dataplugins/python-dataplugins/" title="Python DataPlugins">
      Python DataPlugins
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../preview-features/preview-features/" title="Preview Features">
      Preview Features
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Upgrading and Migrating SystemLink Server
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#assumptions-and-prerequisites">8.1 
    Assumptions and Prerequisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#preparing-for-upgrade-or-migration">8.2 
    Preparing for Upgrade or Migration
  </a>
<nav aria-label="Preparing for Upgrade or Migration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ni-systemlink-migration-command-line-utility">8.2.1 
    NI-SystemLink-Migration Command Line Utility
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-from-systemlink-213-or-earlier-to-systemlink-215-or-later">8.2.2 
    Upgrading from SystemLink 21.3 or earlier to SystemLink 21.5 or later
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recommended-upgrade-and-migration-workflows-for-your-deployment">8.3 
    Recommended Upgrade and Migration Workflows for your deployment
  </a>
<nav aria-label="Recommended Upgrade and Migration Workflows for your deployment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-upgrade">8.3.1 
    Single Node Upgrade
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-to-multi-node-migration">8.3.2 
    Single Node to Multi Node Migration
  </a>
<nav aria-label="Single Node to Multi Node Migration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-to-multi-node-with-mongodb">8.3.2.1 
    Single Node to Multi Node with MongoDB
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-to-multi-node-with-file-storage">8.3.2.2 
    Single Node to Multi Node with File Storage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#single-node-to-multi-node-with-postgresql">8.3.2.3 
    Single Node to Multi Node with PostgreSQL
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-multi-node-configurations">8.3.3 
    Upgrading Multi Node Configurations
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#seamless-cut-over">8.4 
    Seamless Cut-over
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/ni/systemlink-operations-handbook/edit/master/handbook/upgrade/upgrade.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="upgrading-and-migrating-systemlink-server"><span class="enumerate-heading-plugin">8.</span> Upgrading and Migrating SystemLink Server<a class="headerlink" href="#upgrading-and-migrating-systemlink-server" title="Permanent link">¶</a></h1>
<p>This chapter covers how to maintain a fully operable SystemLink Server while upgrading to a new version of SystemLink or migrating between SystemLink servers.</p>
<p>To simplify creating and restoring backups, NI recommends running SystemLink Server, attached file stores, and databases within virtual machines. Backing up physical machines is outside the scope of this chapter.</p>
<h2 id="assumptions-and-prerequisites"><span class="enumerate-heading-plugin">8.1</span> Assumptions and Prerequisites<a class="headerlink" href="#assumptions-and-prerequisites" title="Permanent link">¶</a></h2>
<ul>
<li>
<p>A server running SystemLink 2021 R1 or greater. Migrating from older versions of SystemLink is not supported at this time.</p>
</li>
<li>
<p>Familiarity with installing and setting up a SystemLink Server</p>
<ul>
<li>
<p><a href="https://www.ni.com/documentation/en/systemlink/latest/setup/">Setting up a SystemLink Server</a></p>
</li>
<li>
<p><a href="https://www.ni.com/documentation/en/ni-web-server/latest/manual/configuring-ni-web-server/">Configuring NI Web Server</a></p>
<ul>
<li>
<p><a href="/ldap/ldap">Sign on with LDAP</a></p>
</li>
<li>
<p><a href="/openid-connect/openid-connect/">Single Sign-on with OpenID Connect</a></p>
</li>
</ul>
</li>
<li>
<p>Data Store Configuration</p>
<ul>
<li>
<p><a href="/data-stores/mongodb/">MongoDB</a></p>
</li>
<li>
<p><a href="https://www.ni.com/documentation/en/systemlink/latest/setup/remote-mongo-database/">Connecting to a Remote Mongo Database</a></p>
</li>
<li>
<p><a href="https://www.ni.com/documentation/en/systemlink/latest/setup/remote-file-share/">Connecting to a Remote File Share</a></p>
</li>
<li>
<p><a href="https://www.ni.com/documentation/en/systemlink/latest/data/uploading-files-to-amazon-s3/">Uploading Files to Amazon Simple Storage Service (S3)</a></p>
</li>
<li>
<p><a href="https://www.ni.com/documentation/en/systemlink/latest/setup/remote-postgres-databse/">Connecting to a Remote PostgreSQL Database</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Recommended</p>
<ul>
<li>
<p>Virtual machines to run all servers, file stores, a databases</p>
</li>
<li>
<p>Removable storage volume or device</p>
</li>
</ul>
</li>
</ul>
<h2 id="preparing-for-upgrade-or-migration"><span class="enumerate-heading-plugin">8.2</span> Preparing for Upgrade or Migration<a class="headerlink" href="#preparing-for-upgrade-or-migration" title="Permanent link">¶</a></h2>
<p>Before you begin, backup your server and any remote data to avoid unplanned downtime if issues occur during the upgrade or migration process.</p>
<div class="admonition note">
<p class="admonition-title">Single Node versus Multi Node Configurations</p>
<p><strong>Single node</strong> refers to the SystemLink Server configuration where the application server, file storage, and databases used by SystemLink are all installed on the same Windows server. This is the default configuration for SystemLink Server.</p>
<p><strong>Multi node</strong> refers to configurations where one or more file stores or databases used by SystemLink are running on hardware distinct from the SystemLink application server. This is the recommended configuration for all production deployments.</p>
</div>
<h3 id="ni-systemlink-migration-command-line-utility"><span class="enumerate-heading-plugin">8.2.1</span> NI-SystemLink-Migration Command Line Utility<a class="headerlink" href="#ni-systemlink-migration-command-line-utility" title="Permanent link">¶</a></h3>
<p>The workflows for upgrades and migrations makes use of the SystemLink command line migration tool, <code>nislmigrate</code>. Refer to the <a href="https://pypi.org/project/nislmigrate/">NI-SystemLink-Migration</a> documentation in PyPi for details on installing and using this tool.</p>
<div class="admonition important">
<p class="admonition-title">Limitations of <code>nislmigrate</code></p>
<p>The NI-SystemLin-Migration tool does not yet support migrating all data in SystemLink. <a href="https://pypi.org/project/nislmigrate/">Refer to the <strong>Supported Services</strong> table on PyPi</a> for details.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Argument Flags for <code>nislmigrate</code></p>
<p><code>nislmigrate</code> supports capturing data from individual services or can capture data from all installed services using the <code>--all</code> argument flag. For brevity <code>--all</code> is used most workflows in this chapter. Depending on your needs you may replace the <code>--all</code> argument flag with one or more of the individual service argument flags.</p>
</div>
<h3 id="upgrading-from-systemlink-213-or-earlier-to-systemlink-215-or-later"><span class="enumerate-heading-plugin">8.2.2</span> Upgrading from SystemLink 21.3 or earlier to SystemLink 21.5 or later<a class="headerlink" href="#upgrading-from-systemlink-213-or-earlier-to-systemlink-215-or-later" title="Permanent link">¶</a></h3>
<p>After upgrading from SystemLink 21.3 or earlier to SystemLink 21.5 or later, SystemLink will migrate your test steps, results, and products from MongoDB to PostgreSQL. Depending on the size of your data set this process may take some time. For reference, a typical server takes less than one hour to migrate 5 million steps. To check the step count on your server, you can use the Mongo shell or a client such as Robo 3T. The credentials required for connecting to the database can be found in <code>C:\ProgramData\National Instruments\Skyline\Config\TestMonitor.json</code>. Use the step count to roughly estimate the expected migration time. Note that system resources and network connectivity will impact the migration time.</p>
<p>If Test Monitor is using the local instance of MongoDB stored in the default location, the migration will occur automatically. If not, the migration must be approved on the TestMonitor tab in the <strong>NI SystemLink Server Configuration</strong> application.</p>
<p>The TestMonitor service will display a status of <strong>Migrating</strong> during this process. You can view detailed status of this process with <code>C:\ProgramData\National Instruments\Skyline\Logs\log.txt</code>.</p>
<p>If you see an error, double check your connection string and restart SystemLink Service Manager.</p>
<h2 id="recommended-upgrade-and-migration-workflows-for-your-deployment"><span class="enumerate-heading-plugin">8.3</span> Recommended Upgrade and Migration Workflows for your deployment<a class="headerlink" href="#recommended-upgrade-and-migration-workflows-for-your-deployment" title="Permanent link">¶</a></h2>
<p>While you should plan for some downtime of your SystemLink Server, you can minimize that downtime by following these recommendations.</p>
<ul>
<li><a href="#single-node-upgrade">8.3.1 Single Node Upgrade</a></li>
<li><a href="#single-node-to-multi-node-migration">8.3.2 Single Node to Multi Node Migration</a><ul>
<li><a href="#single-node-to-multi-node-with-mongodb">8.3.2.1 Single Node to Multi Node with MongoDB</a></li>
<li><a href="#single-node-to-multi-node-with-file-storage">8.3.2.2 Single Node to Multi Node with File Storage</a></li>
<li><a href="#single-node-to-multi-node-with-postgresql">8.3.2.3 Single Node to Multi Node with PostgreSQL</a></li>
</ul>
</li>
<li><a href="#upgrading-multi-node-configurations">8.3.3 Upgrading Multi node configurations (MongoDB, PostgreSQL, File Share/S3)</a></li>
<li><a href="#seamless-cut-over">8.4 Seamless cut-over</a></li>
</ul>
<p>If you have a SystemLink Server with a small amount of data, you can use <code>nislmigrate</code> to backup your data to the local file system of your SystemLink Server. For SystemLink Servers with a large amount of data, you may need to use an attached volume since the backup created by <code>nislmigrate</code> may exhaust the local storage. This document assumes that you are using an attached volume and refers to the volume as <code>D:\</code> in each workflow.</p>
<div class="admonition important">
<p class="admonition-title">Storing Sensitive Data</p>
<p>The migration of systems data (<code>--all</code> or <code>--systems</code>) will migrate the private key used decrypt communication between your SystemLink server and test systems. In this case, <code>nislmigrate</code> requires the use of the <code>--secret</code> argument to encrypt this key. While this provides some assurances of the security of this private key, it is the users responsibility to ensure this private key and sensitive production data are properly handled during migration and after the process is complete.</p>
</div>
<h3 id="single-node-upgrade"><span class="enumerate-heading-plugin">8.3.1</span> Single Node Upgrade<a class="headerlink" href="#single-node-upgrade" title="Permanent link">¶</a></h3>
<p>Complete the following steps to upgrade a single node deployment of SystemLink Server.</p>
<p>Though the NI Package Manager (NIPM) installer for SystemLink supports in-place upgrades where the upgrade runs directly on your current SystemLink Server, NI does not recommend this option. If you choose this option, ensure that you backup your server before beginning the upgrade.</p>
<p>For single node upgrades, NI recommends upgrading and migrating at the same time to mitigate issues during the upgrade by ensuring your original SystemLink Server remains operable.</p>
<ol>
<li>
<p>Backup your SystemLink Server.</p>
</li>
<li>
<p>Attach a volume to store data captured by <code>nislmigrate</code>. This will be referenced as <code>D:\</code>.</p>
</li>
<li>
<p>Install <code>nislmigrate</code>.</p>
</li>
<li>
<p>Run the command <code>nislmigrate capture --all --secret &lt;your secret&gt; --dir D:\migration</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While <code>nislmigrate</code> runs all SystemLink services are stopped. Plan ahead for this downtime of your SystemLink server. When the capture is completed, SystemLink services will be restarted automatically.</p>
</div>
</li>
<li>
<p>Detach <code>D:\</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After this step, your original SystemLink Server is still operable, but any new data created or consumed by SystemLink Server at this time will not be available to your new server.</p>
</div>
</li>
<li>
<p>Provision a new Windows server for SystemLink.</p>
</li>
<li>
<p>Install and configure the new version of SystemLink Server.</p>
</li>
<li>
<p>Install <code>nislmigrate</code> on your new SystemLink Server.</p>
</li>
<li>
<p>Attach the <code>D:\</code> volume used to capture data from your original SystemLink Server.</p>
</li>
<li>
<p>Run the command <code>nislmigrate restore --all --secret &lt;your secret&gt; --dir D:\migration</code>.</p>
</li>
<li>
<p>Verify your new SystemLink Server has all the expected migrated data.</p>
</li>
</ol>
<h3 id="single-node-to-multi-node-migration"><span class="enumerate-heading-plugin">8.3.2</span> Single Node to Multi Node Migration<a class="headerlink" href="#single-node-to-multi-node-migration" title="Permanent link">¶</a></h3>
<p>This section describes workflows to prepare to upgrade or migrate from a single node SystemLink Server configuration to a multi node SystemLink Server configuration that makes use of dedicated servers for MongoDB, PostgreSQL, or file storage.</p>
<h4 id="single-node-to-multi-node-with-mongodb"><span class="enumerate-heading-plugin">8.3.2.1</span> Single Node to Multi Node with MongoDB<a class="headerlink" href="#single-node-to-multi-node-with-mongodb" title="Permanent link">¶</a></h4>
<p>Complete the following steps to upgrade a single node deployment of SystemLink Server to a multi node deployment where the MongoDB instance used by SystemLink is hosted on its own server or replica set.</p>
<ol>
<li>
<p>Backup your SystemLink Server.</p>
</li>
<li>
<p>Attach a volume to store data captured by <code>nislmigrate</code>. This will be referenced as <code>D:\</code>.</p>
</li>
<li>
<p>Install <code>nislmigrate</code>.</p>
</li>
<li>
<p>Run the command <code>nislmigrate capture --all --secret &lt;your secret&gt; --dir D:\migration</code>.</p>
</li>
<li>
<p>Detach <code>D:\</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After this step, your original SystemLink Server is still operable, but any new data created or consumed by SystemLink Server at this time will not be available to your new server.</p>
</div>
</li>
<li>
<p>Provision a new Windows server for SystemLink.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While not required, provisioning a new SystemLink Server ensures your original SystemLink Server is always in an operable state.</p>
</div>
</li>
<li>
<p><a href="/data-stores/mongodb/#multi-node-deployments">Provision a new MongoDB server or replica set</a>.</p>
</li>
<li>
<p>Install and configure the same or a newer version of SystemLink Server.</p>
</li>
<li>
<p>Configure SystemLink to use the newly created MongoDB server or replica set.</p>
</li>
<li>
<p>Install <code>nislmigrate</code> on your new SystemLink Server.</p>
</li>
<li>
<p>Attach the <code>D:\</code> volume used to capture data from your original SystemLink server.</p>
</li>
<li>
<p>Run the command <code>nislmigrate restore --all --secret &lt;your secret&gt; --dir D:\migration</code>.</p>
</li>
<li>
<p>Verify your new SystemLink Server has all the expected migrated data.</p>
</li>
</ol>
<h4 id="single-node-to-multi-node-with-file-storage"><span class="enumerate-heading-plugin">8.3.2.2</span> Single Node to Multi Node with File Storage<a class="headerlink" href="#single-node-to-multi-node-with-file-storage" title="Permanent link">¶</a></h4>
<p>Complete the following steps to upgrade a single node deployment of SystemLink Server to a multi node deployment where the file storage instance used by SystemLink is hosted on sa dedicated NAS, SAN, or AWS S3.</p>
<ol>
<li>
<p>Backup your SystemLink Server.</p>
</li>
<li>
<p>Attach a volume to store data captured by <code>nislmigrate</code>. This will be referenced as <code>D:\</code>.</p>
</li>
<li>
<p>Install <code>nislmigrate</code>.</p>
</li>
<li>
<p>Run the command <code>nislmigrate capture --all --secret &lt;your secret&gt; --dir D:\migration</code>.</p>
</li>
<li>
<p>Copy the files from the original file storage location to the new file store using one of the following options.</p>
<table>
<thead>
<tr>
<th>Destination</th>
<th>Recommended Tool</th>
</tr>
</thead>
<tbody>
<tr>
<td>NAS</td>
<td>File Explorer or PowerShell</td>
</tr>
<tr>
<td>SAN</td>
<td>File Explorer or PowerShell</td>
</tr>
<tr>
<td>AWS S3</td>
<td><a href="https://aws.amazon.com/cli/">AWS CLI</a></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Detach <code>D:\</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After this step, your original SystemLink Server is still operable, but any new data created or consumed by SystemLink Server at this time will not be available to your new server.</p>
</div>
</li>
<li>
<p>Provision a new file store for SystemLink.</p>
</li>
<li>
<p>Install and configure the same or a newer version of SystemLink Server.</p>
</li>
<li>
<p>Configure SystemLink to use the newly created file storage location.</p>
</li>
<li>
<p>Install <code>nislmigrate</code> on your new SystemLink Server.</p>
</li>
<li>
<p>Attach the <code>D:\</code> volume used to capture data from your original SystemLink server.</p>
</li>
<li>
<p>Run the command <code>nislmigrate restore --all --secret &lt;your secret&gt; --change-file-store-root &lt;new root&gt; --dir D:\migration</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must use the <code>--change-file-store-root argument</code> flag to update the file meta data the new root location of your file storage. Otherwise, you will not be able to preview or download files. Depending on your configuration, this could be a new drive letter, UNC path, or S3 URL.</p>
<table>
<thead>
<tr>
<th>Migration Destination</th>
<th>Example <code>nislmigrate</code> Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>New drive and directory</td>
<td><code>nislmigrate restore --all --secret &lt;your secret&gt; --change-file-store-root X:\systemlink\data --dir D:\migration</code></td>
</tr>
<tr>
<td>UNC path</td>
<td><code>nislmigrate restore --all --secret &lt;your secret&gt; --change-file-store-root \\FileShare\systemlink\data --dir D:\migration</code></td>
</tr>
<tr>
<td>AWS S3</td>
<td><code>nislmigrate restore --all --secret &lt;your secret&gt; --change-file-store-root s3://yours3bucket/systemlink/data/ --dir D:\migration</code></td>
</tr>
</tbody>
</table>
</div>
</li>
<li>
<p>Verify your new SystemLink Server has all the expected migrated data.</p>
</li>
</ol>
<h4 id="single-node-to-multi-node-with-postgresql"><span class="enumerate-heading-plugin">8.3.2.3</span> Single Node to Multi Node with PostgreSQL<a class="headerlink" href="#single-node-to-multi-node-with-postgresql" title="Permanent link">¶</a></h4>
<p>Complete the following steps to upgrade a single node deployment of SystemLink Server to a multi node deployment where the PostgreSQL instance used by the SystemLink Test Monitor service is hosted on a its own server or replica set. The Test Monitor Service performs the migration of test steps, test results, and product from MongoDB to PostgreSQL.</p>
<p>As of SystemLink 21.5, SystemLink supports using a local or external PostgreSQL database for the Test Monitor service. <code>nislmigrate</code> does not yet support migrating between PostgreSQL servers or replica sets.</p>
<ol>
<li>
<p>Backup your SystemLink Server.</p>
</li>
<li>
<p>Attach a volume to store data captured by <code>nislmigrate</code>. This will be referenced as <code>D:\</code>.</p>
</li>
<li>
<p>Install <code>nislmigrate</code>.</p>
</li>
<li>
<p>Run the command <code>nislmigrate capture --all --secret &lt;your secret&gt; --dir D:\migration</code>.</p>
</li>
<li>
<p>Detach <code>D:\</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After this step, your original SystemLink Server is still operable, but any new data created or consumed by SystemLink Server at this time will not be available to your new server.</p>
</div>
</li>
<li>
<p>Provision a new Windows server for SystemLink.</p>
</li>
<li>
<p>Provision a PostgreSQL server or replica set.</p>
</li>
<li>
<p>Install and configure SystemLink 21.5 or later.</p>
</li>
<li>
<p>Install <code>nislmigrate</code> on your new SystemLink Server.</p>
</li>
<li>
<p>Attach the <code>D:\</code> volume used to capture data from your original SystemLink server.</p>
</li>
<li>
<p>Run the command <code>nislmigrate restore --all --secret &lt;your secret&gt; --dir D:\migration</code>.</p>
</li>
<li>
<p>Open the <strong>NI SystemLink Server Configuration</strong> application.</p>
</li>
<li>
<p>Navigate to PostgreSQLDatabase and connect to your external PostgreSQL database. See the <a href="https://www.ni.com/documentation/en/systemlink/latest/setup/remote-postgres-databse/">SystemLink manual</a> for more details.</p>
</li>
<li>
<p>Navigate to TestMonitor, approve the migration, and click <strong>Apply</strong> to begin the migration.</p>
</li>
<li>
<p>Verify your new SystemLink Server has all the expected migrated data.</p>
</li>
</ol>
<h3 id="upgrading-multi-node-configurations"><span class="enumerate-heading-plugin">8.3.3</span> Upgrading Multi Node Configurations<a class="headerlink" href="#upgrading-multi-node-configurations" title="Permanent link">¶</a></h3>
<p>Complete the following steps to upgrade a SystemLink Server instance that has been configured to use a dedicated MongoDB server or replica set, a dedicated PostgreSQL server or replica set, and a dedicated file store such as AWS S3.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NI recommends using dedicated external data stores for all production deployments. The following workflow assumes you are in this configuration when upgrading SystemLink Server. Refer to the other workflows in this document to migrate your data into this configuration.</p>
</div>
<ol>
<li>
<p>Backup your SystemLink Server, MongoDB server or replica set, PostgreSQL server or replica set, and file store.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If S3 is used as your file store the backup step is not needed since this managed internally by AWS.</p>
</div>
</li>
<li>
<p>Attach a volume to store data captured by <code>nislmigrate</code>. This will be referenced as <code>D:\</code>.</p>
</li>
<li>
<p>Install <code>nislmigrate</code>.</p>
</li>
<li>
<p>Run the command <code>nislmigrate capture --tags --dir D:\migration</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While most of the data is external to SystemLink, tag current values are stored on the app server. Therefore this <code>nislmigrate</code> argument flag must be used to ensure that data is not lost during the migration. Be aware this operation will also replace tag history data stored in MongoDB.</p>
</div>
</li>
<li>
<p>Detach <code>D:\</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After this step your original SystemLink Server is in an operable state. Be aware if any new data is created or ingested by the SystemLink server at this time it will not be available to your new server.</p>
</div>
</li>
<li>
<p>Provision a new Windows server for SystemLink.</p>
</li>
<li>
<p>Provision a MongoDB server or replica set from the backup previously created.</p>
</li>
<li>
<p>Provision a PostgreSQL server or replica set from the backup previously created.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The previous steps prescribe using a newly created instance of your MongoDB or PostgreSQL servers. This is because SystemLink may change the internal schema of these databases when services start post upgrade. If you do not start with an instance from a backup you will be unable to revert the MongoDB collections and PostgreSQL tables into the schemas needed for the older version of SystemLink.</p>
</div>
</li>
<li>
<p>Install and configure the new version of SystemLink Server.</p>
</li>
<li>
<p>Configure SystemLink to use the newly created MongoDB server or replica set, PostgreSQL server or replica set, and existing file store.</p>
</li>
<li>
<p>Install <code>nislmigrate</code> on your new SystemLink Server.</p>
</li>
<li>
<p>Attach the <code>D:\</code> volume used to capture data from your original SystemLink server.</p>
</li>
<li>
<p>Run the command <code>nislmigrate restore --tags --dir D:\migration</code>.</p>
</li>
<li>
<p>Verify your new SystemLink Server has all the expected migrated data.</p>
</li>
</ol>
<h2 id="seamless-cut-over"><span class="enumerate-heading-plugin">8.4</span> Seamless Cut-over<a class="headerlink" href="#seamless-cut-over" title="Permanent link">¶</a></h2>
<p>Since managed test systems are connected SystemLink test systems can connect to the new instance of SystemLink without manual intervention. To accomplish this the following conditions must be met:</p>
<ul>
<li>
<p>Migration of systems data.</p>
<ul>
<li>This is either accomplished by using the <code>nislmigrate</code> argument flags <code>--all</code> or <code>--systems</code>. These migration arguments must be used even in cases where an external MongoDB server or replica set is used. Otherwise the systems management private key is not retained and test systems will need to be approved again to connect to your SystemLink server.</li>
</ul>
</li>
<li>
<p>The DNS name of the original SystemLink Server and the new SystemLink Server are the same.</p>
</li>
<li>
<p>If NI Web Server has been configured for HTTPS, the new SystemLink Server must use the same TLs certificate as the original SystemLink Server.</p>
</li>
</ul>
<hr/>
<div class="md-source-date">
<small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">March 15, 2022</span>
</small>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../../data-stores/mongodb/" rel="prev" title="MongoDB">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                MongoDB
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../../python-dataplugins/python-dataplugins/" rel="next" title="Python DataPlugins">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Python DataPlugins
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2020 National Instruments Corporation
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.3636a4ec.min.js"></script>
<script src="../../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>